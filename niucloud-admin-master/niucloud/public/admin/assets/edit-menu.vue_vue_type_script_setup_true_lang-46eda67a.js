import{d as Z,r as y,l as H,X as J,k as t,h as f,m as h,w as n,a as S,e as a,i as m,t as i,u,J as c,B as X,c as Q,F as W,T as Y,ae as b,D as ee,G as le,af as ae,ag as te,a3 as oe,ah as ne,ai as ue,aj as de,H as re,E as se,S as me,M as ie}from"./index-9f163f98.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                 *//* empty css                        */import pe from"./index-6ad4c4fc.js";/* empty css               *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                *//* empty css                    *//* empty css                       *//* empty css                       *//* empty css                 */import"./el-form-item-4ed993c7.js";import{e as _e,c as fe,f as ce,h as ye,i as he}from"./sys-135535fa.js";import{g as be}from"./tools-3c2d984d.js";const ve={class:"input-width"},Ve={class:"dialog-footer"},Ge=Z({__name:"edit-menu",emits:["complete"],setup(ge,{expose:F,emit:I}){const v=y(!1),p=y(!1);let w="";const P={id:0,menu_name:"",menu_type:0,parent_key:"",icon:"",api_url:"",router_path:"",view_path:"",methods:"post",sort:"",status:1,is_show:1,menu_key:"",addon:"",menu_short_name:""},e=H({...P}),k=y([]),M=y([]),E=y([]),U=y(),B=d=>/^([a-zA-Z_$])([a-zA-Z0-9_$])*$/.test(d),C=J(()=>({menu_name:[{required:!0,message:t("menuNamePlaceholder"),trigger:"blur"}],menu_key:[{required:!0,message:t("menuKeyPlaceholder"),trigger:"blur"},{validator:(d,l,r)=>{B(l)||r(new Error(t("menuKeyValidata"))),r()},trigger:"blur"}],router_path:[{required:e.menu_type==1,message:t("routePathPlaceholder"),trigger:"blur"}],view_path:[{required:e.menu_type==1,message:t("viewPathPlaceholder"),trigger:"blur"}],api_url:[{required:e.menu_type==2,message:t("authIdPlaceholder"),trigger:"blur"}]})),A=async()=>{const{data:d}=await be({});k.value=[{title:"系统",key:""}],k.value.push(...d)},L=async()=>{const{data:d}=await ye();M.value=[{menu_name:"顶级",menu_key:""}],M.value.push(...d)},D=async d=>{const{data:l}=await he(d);E.value=l},q=async d=>{e.parent_key="",d!=""&&(await D(d),e.parent_key=E.value[0].menu_key)},K=async d=>{if(p.value||!d)return;const l=e.id?_e:fe;await d.validate(async(r,s)=>{r&&(p.value=!0,l(e).then(g=>{p.value=!1,v.value=!1,I("complete")}).catch(()=>{p.value=!1}))})};return F({showDialog:v,setFormData:async(d=null)=>{if(p.value=!0,Object.assign(e,P),w=t("addMenu"),A(),L(),d.menu_key){w=t("updateMenu");const l=await(await ce(d.menu_key)).data;Object.keys(e).forEach(r=>{l[r]!=null&&(e[r]=l[r])}),e.addon!=""&&D(e.addon)}else Object.keys(e).forEach(l=>{d[l]!=null&&(e[l]=d[l])});p.value=!1}}),(d,l)=>{const r=ee,s=le,_=ae,g=te,V=oe,T=ne,x=ue,O=pe,R=de,$=re,N=se,j=me,G=ie;return f(),h(j,{modelValue:v.value,"onUpdate:modelValue":l[17]||(l[17]=o=>v.value=o),title:u(w),width:"500px","destroy-on-close":!0},{footer:n(()=>[S("span",Ve,[a(N,{onClick:l[15]||(l[15]=o=>v.value=!1)},{default:n(()=>[m(i(u(t)("cancel")),1)]),_:1}),a(N,{type:"primary",loading:p.value,onClick:l[16]||(l[16]=o=>K(U.value))},{default:n(()=>[m(i(u(t)("confirm")),1)]),_:1},8,["loading"])])]),default:n(()=>[c((f(),h($,{model:e,"label-width":"90px",class:"page-form",ref_key:"formRef",ref:U,rules:u(C)},{default:n(()=>[a(s,{label:u(t)("menuName"),prop:"menu_name"},{default:n(()=>[a(r,{modelValue:e.menu_name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.menu_name=o),modelModifiers:{trim:!0},maxlength:"10","show-word-limit":"",placeholder:u(t)("menuNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e.id?X("",!0):(f(),h(s,{key:0,label:u(t)("menuKey"),prop:"menu_key"},{default:n(()=>[a(r,{modelValue:e.menu_key,"onUpdate:modelValue":l[1]||(l[1]=o=>e.menu_key=o),modelModifiers:{trim:!0},maxlength:"50","show-word-limit":"",placeholder:u(t)("menuKeyPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])),a(s,{label:u(t)("menuType")},{default:n(()=>[a(g,{modelValue:e.menu_type,"onUpdate:modelValue":l[2]||(l[2]=o=>e.menu_type=o)},{default:n(()=>[a(_,{label:0},{default:n(()=>[m(i(u(t)("menuTypeDir")),1)]),_:1}),a(_,{label:1},{default:n(()=>[m(i(u(t)("menuTypeMenu")),1)]),_:1}),a(_,{label:2},{default:n(()=>[m(i(u(t)("menuTypeButton")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(s,{label:u(t)("addon"),prop:"addon"},{default:n(()=>[a(T,{modelValue:e.addon,"onUpdate:modelValue":l[3]||(l[3]=o=>e.addon=o),placeholder:u(t)("addon"),class:"input-width",onChange:q},{default:n(()=>[(f(!0),Q(W,null,Y(k.value,(o,z)=>(f(),h(V,{label:o.title,value:o.key,key:z},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(s,{label:u(t)("parentMenu"),prop:"parent_key"},{default:n(()=>[e.addon!=""?(f(),h(x,{key:0,class:"input-width",modelValue:e.parent_key,"onUpdate:modelValue":l[4]||(l[4]=o=>e.parent_key=o),props:{label:"menu_name",value:"menu_key"},data:E.value,"check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"])):(f(),h(x,{key:1,class:"input-width",modelValue:e.parent_key,"onUpdate:modelValue":l[5]||(l[5]=o=>e.parent_key=o),props:{label:"menu_name",value:"menu_key"},data:M.value,"check-strictly":"","render-after-expand":!1},null,8,["modelValue","data"]))]),_:1},8,["label"]),c(a(s,{label:u(t)("routePath"),prop:"router_path"},{default:n(()=>[a(r,{modelValue:e.router_path,"onUpdate:modelValue":l[6]||(l[6]=o=>e.router_path=o),modelModifiers:{trim:!0},placeholder:u(t)("routePathPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),[[b,e.menu_type==1]]),c(a(s,{label:u(t)("viewPath"),prop:"view_path"},{default:n(()=>[a(r,{modelValue:e.view_path,"onUpdate:modelValue":l[7]||(l[7]=o=>e.view_path=o),modelModifiers:{trim:!0},placeholder:u(t)("viewPathPlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),[[b,e.menu_type==1]]),c(a(s,{label:u(t)("authId"),prop:"api_url"},{default:n(()=>[a(r,{modelValue:e.api_url,"onUpdate:modelValue":l[9]||(l[9]=o=>e.api_url=o),modelModifiers:{trim:!0},placeholder:u(t)("authIdPlaceholder"),class:"input-width"},{append:n(()=>[a(T,{class:"border-none",style:{width:"100px"},modelValue:e.methods,"onUpdate:modelValue":l[8]||(l[8]=o=>e.methods=o)},{default:n(()=>[a(V,{label:"POST",value:"post"}),a(V,{label:"GET",value:"get"}),a(V,{label:"PUT",value:"put"}),a(V,{label:"DELETE",value:"delete"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),[[b,e.menu_type!=0]]),c(a(s,{label:u(t)("menuIcon"),prop:"icon"},{default:n(()=>[S("div",ve,[a(O,{modelValue:e.icon,"onUpdate:modelValue":l[10]||(l[10]=o=>e.icon=o)},null,8,["modelValue"])])]),_:1},8,["label"]),[[b,e.menu_type!=2]]),c(a(s,{label:u(t)("status")},{default:n(()=>[a(g,{modelValue:e.status,"onUpdate:modelValue":l[11]||(l[11]=o=>e.status=o)},{default:n(()=>[a(_,{label:1},{default:n(()=>[m(i(u(t)("statusNormal")),1)]),_:1}),a(_,{label:0},{default:n(()=>[m(i(u(t)("statusDeactivate")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[b,e.menu_type!=2]]),c(a(s,{label:u(t)("isShow")},{default:n(()=>[a(g,{modelValue:e.is_show,"onUpdate:modelValue":l[12]||(l[12]=o=>e.is_show=o)},{default:n(()=>[a(_,{label:1},{default:n(()=>[m(i(u(t)("show")),1)]),_:1}),a(_,{label:0},{default:n(()=>[m(i(u(t)("hidden")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),[[b,e.menu_type!=2]]),a(s,{label:u(t)("menuShortName")},{default:n(()=>[a(r,{modelValue:e.menu_short_name,"onUpdate:modelValue":l[13]||(l[13]=o=>e.menu_short_name=o),modelModifiers:{trim:!0},placeholder:u(t)("menuShortNamePlaceholder"),class:"input-width"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(s,{label:u(t)("sort")},{default:n(()=>[a(R,{modelValue:e.sort,"onUpdate:modelValue":l[14]||(l[14]=o=>e.sort=o),min:0},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[G,p.value]])]),_:1},8,["modelValue","title"])}}});export{Ge as _};
