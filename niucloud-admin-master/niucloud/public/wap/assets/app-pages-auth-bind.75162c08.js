import{d as e,H as t,m as a,l as r,r as o,q as l,J as s,t as n,o as i,c as p,w as u,b as d,y as c,z as m,e as g,x as b,g as x,n as f,C as _,V as h,a as y,E as v,k,i as S,j,F as C,G as T,R as V,p as w}from"./index-837da579.js";import{_ as F}from"./u-input.3e4051bb.js";import{_ as O,a as P}from"./u-form.e65c84d2.js";import{_ as B}from"./sms-code.vue_vue_type_script_setup_true_lang.58597cb1.js";import{_ as I,a as q}from"./u-checkbox-group.7cf00048.js";import{t as z}from"./topTabbar.ede9ed93.js";import{_ as E}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.963870f0.js";import"./u-line.030b2c5d.js";import"./u-modal.d26bb06e.js";import"./u-loading-icon.57b9bf82.js";import"./u-popup.80b537cf.js";import"./u-transition.38ad69d8.js";const M=E(e({__name:"bind",setup(e){const E=t();z().setTopTabbarParam({title:"",topStatusBar:{bgColor:"#fff",textColor:"#333"}}),a((()=>Object.keys(E.menuButtonInfo).length?V(Number(E.menuButtonInfo.height))+V(E.menuButtonInfo.top)+V(8)+"rpx":"auto"));const M=r(),U=a((()=>M.info)),A=a((()=>w().login)),R=o(!1),G=o(!1),H=l({mobile:"",mobile_code:"",mobile_key:"",register_type:""}),J=o(!0);s((e=>{setTimeout((()=>{J.value=!1}),800),e.register_type&&Object.assign(H,{register_type:e.register_type}),uni.getStorageSync("openid")&&Object.assign(H,{openid:uni.getStorageSync("openid")}),uni.getStorageSync("pid")&&Object.assign(H,{pid:uni.getStorageSync("pid")}),uni.getStorageSync("unionid")&&Object.assign(H,{unionid:uni.getStorageSync("unionid")}),uni.getStorageSync("nickname")&&Object.assign(H,{nickname:uni.getStorageSync("nickname")}),uni.getStorageSync("avatar")&&Object.assign(H,{avatar:uni.getStorageSync("avatar")})}));const L={mobile:[{type:"string",required:!0,message:n("mobilePlaceholder"),trigger:["blur","change"]},{validator(e,t,a){/^1[3-9]\d{9}$/.test(t)?a():a(new Error("请输入正确的手机号"))},message:n("mobileError"),trigger:["change","blur"]}],mobile_code:{type:"string",required:!0,message:n("codePlaceholder"),trigger:["blur","change"]}},N=()=>{G.value=!G.value},$=o(null),D=()=>{$.value.validate().then((()=>{if(R.value)return;R.value=!0;(U.value?_:h)(H).then((e=>{U.value?(M.getMemberInfo(),y({url:"/app/pages/member/personal",mode:"redirectTo"})):(M.setToken(e.data.token),v().handleLoginBack())})).catch((()=>{R.value=!1}))}))};return(e,t)=>{const a=k,r=S(j("u-input"),F),o=S(j("u-form-item"),O),l=S(j("sms-code"),B),s=S(j("u-form"),P),_=S(j("u-checkbox"),I),h=S(j("u-checkbox-group"),q),v=C,V=T;return i(),p(a,{class:"w-screen h-screen flex flex-col",style:f(e.themeColor())},{default:u((()=>[d(a,{class:"mx-[60rpx]"},{default:u((()=>[d(a,{class:"pt-[140rpx] text-[50rpx] text-[#333]"},{default:u((()=>[c(m(g(n)("bindMobile")),1)])),_:1}),d(a,{class:"text-[26rpx] leading-[39rpx] text-[var(--text-color-light6)] mt-[24rpx] mb-[90rpx]"},{default:u((()=>[c(m(g(n)("bindMobileTip")),1)])),_:1}),d(s,{labelPosition:"left",model:H,errorType:"toast",rules:L,ref_key:"formRef",ref:$},{default:u((()=>[d(a,{class:"h-[90rpx] flex w-full items-center px-[30rpx] rounded-[40rpx] box-border bg-[#F6F6F6]"},{default:u((()=>[d(o,{label:"",prop:"mobile","border-bottom":!1},{default:u((()=>[d(r,{modelValue:H.mobile,"onUpdate:modelValue":t[0]||(t[0]=e=>H.mobile=e),type:"number",maxlength:"11",border:"none",placeholder:g(n)("mobilePlaceholder"),class:"!bg-transparent",disabled:J.value,fontSize:"26rpx",placeholderClass:"!text-[var(--text-color-light9)] text-[26rpx]"},null,8,["modelValue","placeholder","disabled"])])),_:1})])),_:1}),d(a,{class:"h-[90rpx] flex w-full items-center px-[30rpx] rounded-[40rpx] box-border bg-[#F6F6F6] mt-[40rpx]"},{default:u((()=>[d(o,{label:"",prop:"mobile_code","border-bottom":!1},{default:u((()=>[d(r,{modelValue:H.mobile_code,"onUpdate:modelValue":t[2]||(t[2]=e=>H.mobile_code=e),type:"number",maxlength:"4",border:"none",placeholder:g(n)("codePlaceholder"),class:"!bg-transparent",disabled:J.value,fontSize:"26rpx",placeholderClass:"!text-[var(--text-color-light9)]"},{suffix:u((()=>[d(l,{mobile:H.mobile,type:"bind_mobile",modelValue:H.mobile_key,"onUpdate:modelValue":t[1]||(t[1]=e=>H.mobile_key=e)},null,8,["mobile","modelValue"])])),_:1},8,["modelValue","placeholder","disabled"])])),_:1})])),_:1})])),_:1},8,["model"]),d(a,{class:"mt-[100rpx]"},{default:u((()=>[g(A).agreement_show?(i(),p(a,{key:0,class:"flex items-center mb-[20rpx] py-[10rpx]",onClick:b(N,["stop"])},{default:u((()=>[d(h,{onChange:N},{default:u((()=>[d(_,{activeColor:"var(--primary-color)",checked:G.value,shape:"circle",size:"24rpx",customStyle:{marginTop:"4rpx"}},null,8,["checked"])])),_:1}),d(a,{class:"text-[24rpx] text-[var(--text-color-light6)] flex items-center flex-wrap"},{default:u((()=>[d(v,null,{default:u((()=>[c(m(g(n)("agreeTips")),1)])),_:1}),d(v,{onClick:t[3]||(t[3]=b((e=>g(y)({url:"/app/pages/auth/agreement?key=privacy"})),["stop"])),class:"text-primary"},{default:u((()=>[c("《"+m(g(n)("privacyAgreement"))+"》",1)])),_:1}),d(v,null,{default:u((()=>[c(m(g(n)("and")),1)])),_:1}),d(v,{onClick:t[4]||(t[4]=b((e=>g(y)({url:"/app/pages/auth/agreement?key=service"})),["stop"])),class:"text-primary"},{default:u((()=>[c("《"+m(g(n)("userAgreement"))+"》",1)])),_:1})])),_:1})])),_:1},8,["onClick"])):x("v-if",!0),d(V,{class:"w-full h-[80rpx] !bg-[var(--primary-color)] text-[26rpx] rounded-[40rpx] leading-[80rpx] font-500 !text-[#fff]",onClick:D},{default:u((()=>[c(m(g(n)("bind")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["style"])}}}),[["__scopeId","data-v-5d268fa1"]]);export{M as default};
