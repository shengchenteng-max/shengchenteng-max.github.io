import{d as G,r as x,l as H,X as L,h,m as w,w as r,a as u,e as i,i as k,u as C,A as X,aO as T,c as F,F as R,T as D,t as U,O as _,Y,D as z,G as J,H as Q,b6 as W,E as Z,S as ee}from"./index-9f163f98.js";/* empty css                  *//* empty css                   *//* empty css                  *//* empty css                        *//* empty css                 *//* empty css                */import"./el-form-item-4ed993c7.js";import{_ as te}from"./add-theme.vue_vue_type_script_setup_true_lang-a2796768.js";import{u as le}from"./diy-700f9c59.js";import{e as ae,b as oe}from"./diy-3042ded9.js";const ne={class:"form-tip"},se={class:"flex items-center"},re=["onClick"],ie=["onClick"],de={class:"form-tip"},ue=u("span",{class:"mr-[3px]"},"+",-1),me=u("span",null,"新增颜色",-1),pe=[ue,me],fe=u("div",{class:"form-tip"},"新增颜色key值不能与当前的存在的key值重复",-1),ce={class:"dialog-footer"},$e=G({__name:"edit-theme",emits:["confirm"],setup(he,{expose:A,emit:B}){const V=le(),f=x(!1),g=x(),t=H({title:"",id:"",theme:{},default_theme:{},new_theme:[],key:"",theme_field:[]}),E=x(),I=L(()=>({title:[{required:!0,message:"请输入色调名称",trigger:"blur"}]})),d=x(),O=l=>{Object.keys(t).forEach(e=>{t[e]=l[e]!=null?_(l[e]):""}),d.value=[..._(t.theme_field)],d.value.forEach((e,a)=>{e.value=l.theme[e.label]?l.theme[e.label]:e.value}),f.value=!0},S=()=>{const l=[];d.value.forEach((a,s)=>{l.push(a.label)});const e={key:l};g.value.open(e)},j=l=>{const e=[];d.value.forEach((s,n)=>{e.push(s.label)});const a={key:e,data:l};g.value.open(a)},N=l=>{let e=-1;for(let a=0;a<t.new_theme.length;a++)t.new_theme[a].label==l.label&&(e=a);e>-1&&t.new_theme.splice(e,1)},q=l=>{for(let e=0;e<t.new_theme.length;e++)if(t.new_theme[e].label==l.label){t.new_theme[e]=l;return}t.new_theme.push(l)},K=()=>{t.default_theme&&Object.keys(t.default_theme).length?d.value.forEach((l,e)=>{l.value=t.default_theme[l.label]}):(d.value=_(t.theme_field),t.id||(t.title="")),t.new_theme=[],Y({message:"重置成功",type:"success"})};let v=!1;const M=async l=>{l&&await l.validate(async e=>{if(e){const a={title:"",id:"",theme:{},default_theme:{},new_theme:[],addon:""};a.title=t.title,d.value.forEach((n,m)=>{a.theme[n.label]=n.value}),t.new_theme.forEach((n,m)=>{a.theme[n.label]=n.value}),a.new_theme=t.new_theme||[];let s=null;if(t.id?(s=ae,a.id=t.id):s=oe,a.addon=t.key,t.id==""){const n={};t.theme_field.forEach((m,c)=>{n[m.label]=m.value}),a.default_theme=_(n)}else a.default_theme=_(t.default_theme);if(v)return!1;v=!0,s(a).then(n=>{v=!1,f.value=!1,B("confirm",a)}).catch(()=>{v=!1})}})},$=(l,e)=>{const a=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,s=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(,\s*\d*\.?\d+)?\)$/;if(a.test(l)){const n=l.replace("#",""),m=parseInt(n.substring(0,2),16),c=parseInt(n.substring(2,4),16),y=parseInt(n.substring(4,6),16);return`rgba(${m},${c},${y},${e})`}else if(s.test(l))return l.replace(/[\d\.]+\)$/,`${e})`);return l},P=(l,e)=>{e.label=="--primary-color"&&d.value.forEach((a,s)=>{a.label=="--primary-color-light"&&(a.value=$(e.value,.1)),a.label=="--primary-color-light2"&&(a.value=$(e.value,.8))})};return A({dialogThemeVisible:f,open:O}),(l,e)=>{const a=z,s=J,n=Q,m=W,c=Z,y=ee;return h(),w(y,{modelValue:f.value,"onUpdate:modelValue":e[6]||(e[6]=o=>f.value=o),title:"编辑色调",width:"850px","align-center":"","destroy-on-close":"true"},{footer:r(()=>[u("div",ce,[i(c,{onClick:e[3]||(e[3]=o=>f.value=!1)},{default:r(()=>[k("取消")]),_:1}),i(c,{type:"primary",plain:"",onClick:e[4]||(e[4]=o=>K())},{default:r(()=>[k("重置")]),_:1}),i(c,{type:"primary",onClick:e[5]||(e[5]=o=>M(E.value))},{default:r(()=>[k("保存")]),_:1})])]),default:r(()=>[i(n,{model:t,"label-width":"150px",rules:C(I)},{default:r(()=>[i(s,{label:"色调名称",prop:"title"},{default:r(()=>[i(a,{modelValue:t.title,"onUpdate:modelValue":e[0]||(e[0]=o=>t.title=o),placeholder:"请输入色调名称",maxlength:"15",class:"!w-[250px]",disabled:t.id!="",onKeydown:e[1]||(e[1]=X(T(()=>{},["prevent"]),["enter","native"]))},null,8,["modelValue","disabled"])]),_:1})]),_:1},8,["model","rules"]),i(n,{model:d.value,"label-width":"150px",class:"h-[640px] overflow-auto",ref_key:"formRef",ref:E,onSubmit:e[2]||(e[2]=T(()=>{},["prevent"]))},{default:r(()=>[(h(!0),F(R,null,D(d.value,(o,b)=>(h(),w(s,{label:o.title,key:b,prop:`${b}.value`,rules:[{required:!0,message:`请选择${o.title}色调`,trigger:"blur"}]},{default:r(()=>[i(m,{modelValue:o.value,"onUpdate:modelValue":p=>o.value=p,"show-alpha":"",predefine:C(V).predefineColors,onChange:p=>P(p,o)},null,8,["modelValue","onUpdate:modelValue","predefine","onChange"]),u("div",ne,U(o.tip),1)]),_:2},1032,["label","prop","rules"]))),128)),(h(!0),F(R,null,D(t.new_theme,(o,b)=>(h(),w(s,{label:o.title,key:b},{default:r(()=>[u("div",se,[i(m,{modelValue:o.value,"onUpdate:modelValue":p=>o.value=p,"show-alpha":"",predefine:C(V).predefineColors},null,8,["modelValue","onUpdate:modelValue","predefine"]),u("span",{class:"text-primary cursor-pointer text-[14px] ml-[20px]",onClick:p=>j(o)},"编辑",8,re),u("span",{class:"text-primary cursor-pointer text-[14px] ml-[8px]",onClick:p=>N(o)},"删除",8,ie)]),u("div",de,U(o.tip),1)]),_:2},1032,["label"]))),128)),i(s,null,{default:r(()=>[u("div",{class:"flex items-center text-primary cursor-pointer text-[14px]",onClick:S},pe),fe]),_:1})]),_:1},8,["model"]),i(te,{ref_key:"addThemeRef",ref:g,onConfirm:q},null,512)]),_:1},8,["modelValue"])}}});export{$e as _};
