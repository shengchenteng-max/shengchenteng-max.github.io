import{d as G,r as x,l as N,X as J,k as m,N as X,h as n,m as y,w as i,a as f,e as o,i as p,t as u,u as r,J as Y,c as V,F as U,T as h,B as v,n as R,bn as k,af as Z,ag as ee,G as le,a3 as te,ah as ie,D as oe,Q as ae,aC as me,bj as re,bm as ne,H as _e,E as se,S as ue,M as de}from"./index-9f163f98.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                       *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css                       */import"./el-tooltip-4ed993c7.js";/* empty css               *//* empty css                  *//* empty css                  */import"./el-form-item-4ed993c7.js";/* empty css                       *//* empty css                 */import{g as pe,a as fe}from"./member-6dbdeb9b.js";import{d as ye,f as be}from"./diy_form-8a6dfb58.js";const ce={class:"flex items-center"},ve=f("span",null,"每",-1),we=f("span",null,"可填写",-1),ge=f("span",null,"次",-1),xe={class:"flex items-center"},Ve=f("span",null,"每",-1),Ee=f("span",null,"可填写",-1),Le=f("span",{class:"mr-[5px]"},"次",-1),Te={class:"w-[250px]"},Ue={key:1,class:"flex items-center mt-[5px]"},he=f("span",{class:"mr-[5px]"},"每天",-1),ke=f("span",{class:"ml-[5px]"},"可填写",-1),De={class:"dialog-footer"},Xe=G({__name:"form-write-popup",emits:["complete"],setup(Ce,{expose:z,emit:S}){const w=x(!1),b=x(!1),D={id:0,form_id:0,write_way:"no_limit",join_member_type:"all_member",level_ids:[],label_ids:[],member_write_type:"no_limit",member_write_rule:{time_value:1,time_unit:"day",num:1},form_write_type:"no_limit",form_write_rule:{time_value:1,time_unit:"day",num:1},time_limit_type:"no_limit",time_limit_rule:{specify_time:[],open_day_time:[]},is_allow_update_content:0,write_instruction:""},t=N({...D}),C=x(),B=J(()=>({label_ids:[{required:!0,message:m("labelTips"),trigger:"blur"}],level_ids:[{required:!0,message:m("levelTips"),trigger:"blur"}],member_write_rule:[{validator:(_,e,a)=>{let d="";E.forEach((s,c)=>{s.value==e.time_unit&&(d=s.text)}),t.member_write_type=="diy"?e.time_value?e.num?a():a(new Error(m("numCannotNull"))):a(new Error(`${d}数不能为空`)):a()},trigger:["blur","change"]}],form_write_rule:[{validator:(_,e,a)=>{let d="";E.forEach((s,c)=>{s.value==e.time_unit&&(d=s.text)}),t.member_write_type=="diy"?e.time_value?e.num?a():a(new Error(m("numCannotNull"))):a(new Error(`${d}数不能为空`)):a()},trigger:["blur","change"]}],time_limit_rule:[{validator:(_,e,a)=>{t.time_limit_type=="specify_time"&&(!e.specify_time||!e.specify_time.length)?a(new Error(m("timeLimitRuleOne"))):t.time_limit_type=="open_day_time"&&(!e.open_day_time||!e.open_day_time.length)?a(new Error(m("timeLimitRuleTwo"))):t.time_limit_type=="open_day_time"&&e.open_day_time&&e.open_day_time.length&&e.open_day_time[0]==e.open_day_time[1]?a(new Error(m("timeLimitRuleThree"))):a()},trigger:["blur","change"]}]})),F=x([]),M=x([]);pe().then(({data:_})=>{M.value=_}),fe().then(({data:_})=>{F.value=_});const E=N([{text:"天",value:"day"},{text:"周",value:"week"},{text:"月",value:"month"},{text:"年",value:"year"}]),O=async(_=null)=>{if(Object.assign(t,D),b.value=!0,_){const e=await(await ye(_.form_id)).data;e&&Object.keys(e).length?Object.keys(t).forEach(a=>{e[a]!=null&&(t[a]=e[a])}):t.form_id=_.form_id}b.value=!1},P=async _=>{b.value||!_||await _.validate(async e=>{e&&(b.value=!0,be(t).then(d=>{b.value=!1,w.value=!1,S("complete")}).catch(d=>{b.value=!1}))})};return z({showDialog:w,setFormData:O}),(_,e)=>{const a=Z,d=ee,s=le,c=te,L=ie,T=oe,H=X("QuestionFilled"),Q=ae,I=me,K=re,$=ne,W=_e,j=se,q=ue,A=de;return n(),y(q,{modelValue:w.value,"onUpdate:modelValue":e[20]||(e[20]=l=>w.value=l),title:r(m)("writeSet"),width:"600px",class:"diy-dialog-wrap","close-on-press-escape":!0,"destroy-on-close":!0,"close-on-click-modal":!1},{footer:i(()=>[f("span",De,[o(j,{onClick:e[18]||(e[18]=l=>w.value=!1)},{default:i(()=>[p(u(r(m)("cancel")),1)]),_:1}),o(j,{type:"primary",loading:b.value,onClick:e[19]||(e[19]=l=>P(C.value))},{default:i(()=>[p(u(r(m)("confirm")),1)]),_:1},8,["loading"])])]),default:i(()=>[Y((n(),y(W,{model:t,"label-width":"120px",ref_key:"formRef",ref:C,rules:r(B),class:"page-form"},{default:i(()=>[o(s,{label:r(m)("joinMemberType")},{default:i(()=>[o(d,{modelValue:t.join_member_type,"onUpdate:modelValue":e[0]||(e[0]=l=>t.join_member_type=l)},{default:i(()=>[o(a,{label:"all_member"},{default:i(()=>[p(u(r(m)("allMember")),1)]),_:1}),o(a,{label:"selected_member_level"},{default:i(()=>[p(u(r(m)("selectedMemberLevel")),1)]),_:1}),o(a,{label:"selected_member_label"},{default:i(()=>[p(u(r(m)("selectedMemberLabel")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),t.join_member_type=="selected_member_label"?(n(),y(s,{key:0,label:r(m)("memberLabel"),prop:"label_ids"},{default:i(()=>[o(L,{modelValue:t.label_ids,"onUpdate:modelValue":e[1]||(e[1]=l=>t.label_ids=l),clearable:"",multiple:"",placeholder:r(m)("memberLabelPlaceholder"),class:"input-width"},{default:i(()=>[(n(!0),V(U,null,h(M.value,(l,g)=>(n(),y(c,{label:l.label_name,value:l.label_id,key:g},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):v("",!0),t.join_member_type=="selected_member_level"?(n(),y(s,{key:1,label:r(m)("memberLevel"),prop:"level_ids"},{default:i(()=>[o(L,{modelValue:t.level_ids,"onUpdate:modelValue":e[2]||(e[2]=l=>t.level_ids=l),clearable:"",multiple:"",placeholder:r(m)("memberLevelPlaceholder"),class:"input-width"},{default:i(()=>[(n(!0),V(U,null,h(F.value,(l,g)=>(n(),y(c,{label:l.level_name,value:l.level_id,key:g},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):v("",!0),o(s,{label:r(m)("apieceFillQuantity"),class:R({"!mb-[5px]":t.member_write_type=="diy"})},{default:i(()=>[o(d,{modelValue:t.member_write_type,"onUpdate:modelValue":e[3]||(e[3]=l=>t.member_write_type=l)},{default:i(()=>[o(a,{label:"no_limit"},{default:i(()=>[p(u(r(m)("noLimit")),1)]),_:1}),o(a,{label:"diy"},{default:i(()=>[p(u(r(m)("diy")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label","class"]),t.member_write_type=="diy"?(n(),y(s,{key:2,label:" ",prop:"member_write_rule"},{default:i(()=>[f("div",ce,[ve,o(T,{modelValue:t.member_write_rule.time_value,"onUpdate:modelValue":e[4]||(e[4]=l=>t.member_write_rule.time_value=l),modelModifiers:{trim:!0},onKeyup:e[5]||(e[5]=l=>r(k)(l)),size:"small",class:"!w-[50px] px-[5px]",maxlength:"3"},null,8,["modelValue"]),o(L,{modelValue:t.member_write_rule.time_unit,"onUpdate:modelValue":e[6]||(e[6]=l=>t.member_write_rule.time_unit=l),class:"!w-[60px] pr-[5px]",size:"small"},{default:i(()=>[(n(!0),V(U,null,h(E,(l,g)=>(n(),y(c,{key:l.value,label:l.text,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),we,o(T,{modelValue:t.member_write_rule.num,"onUpdate:modelValue":e[7]||(e[7]=l=>t.member_write_rule.num=l),modelModifiers:{trim:!0},onKeyup:e[8]||(e[8]=l=>r(k)(l)),size:"small",class:"!w-[50px] px-[5px]",maxlength:"3"},null,8,["modelValue"]),ge])]),_:1})):v("",!0),o(s,{label:r(m)("fillQuantityTotal"),class:R({"!mb-[5px]":t.form_write_type=="diy"})},{default:i(()=>[o(d,{modelValue:t.form_write_type,"onUpdate:modelValue":e[9]||(e[9]=l=>t.form_write_type=l)},{default:i(()=>[o(a,{label:"no_limit"},{default:i(()=>[p(u(r(m)("noLimit")),1)]),_:1}),o(a,{label:"diy"},{default:i(()=>[p(u(r(m)("diy")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label","class"]),t.form_write_type=="diy"?(n(),y(s,{key:3,label:" ",prop:"form_write_rule"},{default:i(()=>[f("div",xe,[Ve,o(T,{modelValue:t.form_write_rule.time_value,"onUpdate:modelValue":e[10]||(e[10]=l=>t.form_write_rule.time_value=l),modelModifiers:{trim:!0},onKeyup:e[11]||(e[11]=l=>r(k)(l)),size:"small",class:"!w-[50px] px-[5px]",maxlength:"3"},null,8,["modelValue"]),o(L,{modelValue:t.form_write_rule.time_unit,"onUpdate:modelValue":e[12]||(e[12]=l=>t.form_write_rule.time_unit=l),class:"!w-[60px] pr-[5px]",size:"small"},{default:i(()=>[(n(!0),V(U,null,h(E,(l,g)=>(n(),y(c,{key:l.value,label:l.text,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),Ee,o(T,{modelValue:t.form_write_rule.num,"onUpdate:modelValue":e[13]||(e[13]=l=>t.form_write_rule.num=l),modelModifiers:{trim:!0},onKeyup:e[14]||(e[14]=l=>r(k)(l)),size:"small",class:"!w-[50px] px-[5px]",maxlength:"3"},null,8,["modelValue"]),Le,o(I,{effect:"light",placement:"top"},{content:i(()=>[f("p",Te,u(r(m)("writeTips")),1)]),default:i(()=>[o(Q,null,{default:i(()=>[o(H,{color:"#999999"})]),_:1})]),_:1})])]),_:1})):v("",!0),o(s,{label:r(m)("fillInTheTimePeriod"),prop:"time_limit_rule"},{default:i(()=>[o(d,{modelValue:t.time_limit_type,"onUpdate:modelValue":e[15]||(e[15]=l=>t.time_limit_type=l)},{default:i(()=>[o(a,{label:"no_limit"},{default:i(()=>[p(u(r(m)("noLimit")),1)]),_:1}),o(a,{label:"specify_time"},{default:i(()=>[p(u(r(m)("setSpecifyTime")),1)]),_:1}),o(a,{label:"open_day_time"},{default:i(()=>[p(u(r(m)("openDayTime")),1)]),_:1})]),_:1},8,["modelValue"]),t.time_limit_type=="specify_time"?(n(),y(K,{key:0,modelValue:t.time_limit_rule.specify_time,"onUpdate:modelValue":e[16]||(e[16]=l=>t.time_limit_rule.specify_time=l),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])):v("",!0),t.time_limit_type=="open_day_time"?(n(),V("div",Ue,[he,o($,{class:"!w-[180px]",modelValue:t.time_limit_rule.open_day_time,"onUpdate:modelValue":e[17]||(e[17]=l=>t.time_limit_rule.open_day_time=l),format:"HH:mm","value-format":"HH:mm","is-range":"","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"]),ke])):v("",!0)]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[A,b.value]])]),_:1},8,["modelValue","title"])}}});export{Xe as _};
