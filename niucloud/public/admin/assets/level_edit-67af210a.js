import{d as q,v as D,f as G,r as v,l as N,k as t,h,c as T,e as n,w as u,u as a,ay as $,J as F,m as b,a as i,t as p,B as R,i as H,az as j,L as z,D as A,G as J,H as O,E as Q,M as S}from"./index-9f163f98.js";/* empty css                   *//* empty css                  *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css                *//* empty css                       */import{_ as K}from"./member-benefits.vue_vue_type_script_setup_true_lang-a9145c18.js";import{_ as W}from"./member-gift.vue_vue_type_script_setup_true_lang-2b0ef4ed.js";import{P as X,a as E,Q as Y,R as Z}from"./member-6dbdeb9b.js";import{T as ee}from"./test-71dfb9c1.js";const le={class:"main-container"},te={class:"panel-title !text-sm"},oe={class:"w-[150px]"},ae={class:"text-sm text-gray-400 mb-[5px]"},re={class:"panel-title !text-sm"},se={class:"pl-[100px]"},ne={class:"panel-title !text-sm"},ie={class:"pl-[100px]"},me={class:"fixed-footer-wrap"},de={class:"fixed-footer"},ke=q({__name:"level_edit",setup(ue){const g=D(),x=G(),B=g.meta.title,L=()=>{x.push("/member/level")},V=v(null),y=v(null),_=v(!0),m=v({min:0,max:0}),l=N({level_id:0,level_name:"",remark:"",growth:"",level_benefits:{},level_gifts:{}}),k=v(),M=N({level_name:[{required:!0,message:t("levelNamePlaceholder"),trigger:"blur"}],growth:[{required:!0,message:t("growthPlaceholder"),trigger:"blur"},{validator:(r,e,o)=>{ee.digits(l.growth)||o(t("growthFormatError")),l.growth<=0&&o(t("growthNeedGt")+0),m.value.min&&l.growth<=m.value.min&&o(t("growthNeedGt")+m.value.min),m.value.max&&l.growth>=m.value.max&&o(t("growthNeedLt")+m.value.max),o()}}]});g.query.id?X(g.query.id).then(({data:r})=>{Object.assign(l,r),E().then(({data:e})=>{let o=0;e.forEach((d,f)=>{d.level_id==l.level_id&&(o=f)}),e[o-1]&&(m.value.min=e[o-1].growth),e[o+1]&&(m.value.max=e[o+1].growth)}),_.value=!1}):(E().then(({data:r})=>{r[r.length-1]&&(m.value.min=r[r.length-1].growth)}),_.value=!1);const c=v(!1),P=async r=>{c.value||!r||await r.validate(async e=>{var o,d;if(e){if(!await((o=V.value)==null?void 0:o.verify())||!await((d=y.value)==null?void 0:d.verify()))return;c.value=!0,(l.level_id?Y:Z)(l).then(()=>{x.push({path:"/member/level"})}).catch(()=>{c.value=!1})}})};return(r,e)=>{const o=j,d=z,f=A,w=J,C=O,I=Q,U=S;return h(),T("div",le,[n(d,{class:"card !border-none",shadow:"never"},{default:u(()=>[n(o,{content:a(B),icon:a($),onBack:e[0]||(e[0]=s=>L())},null,8,["content","icon"])]),_:1}),F((h(),b(d,{class:"box-card mt-[15px] !border-none",shadow:"never"},{default:u(()=>[n(C,{class:"page-form",model:l,"label-width":"120px",ref_key:"formRef",ref:k,rules:M},{default:u(()=>[i("h3",te,p(a(t)("basicInfo")),1),n(w,{label:a(t)("levelName"),prop:"level_name"},{default:u(()=>[n(f,{modelValue:l.level_name,"onUpdate:modelValue":e[1]||(e[1]=s=>l.level_name=s),modelModifiers:{trim:!0},placeholder:a(t)("levelNamePlaceholder"),class:"input-width",maxlength:"20","show-word-limit":"",clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(w,{label:a(t)("remark"),prop:"remark"},{default:u(()=>[n(f,{modelValue:l.remark,"onUpdate:modelValue":e[2]||(e[2]=s=>l.remark=s),modelModifiers:{trim:!0},type:"textarea",placeholder:a(t)("remarkPlaceholder"),class:"input-width",clearable:"",rows:"4",maxlength:"200","show-word-limit":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(w,{label:a(t)("growth"),prop:"growth"},{default:u(()=>[i("div",null,[i("div",oe,[n(f,{modelValue:l.growth,"onUpdate:modelValue":e[3]||(e[3]=s=>l.growth=s),modelModifiers:{number:!0,trim:!0},placeholder:a(t)("growthPlaceholder"),clearable:""},null,8,["modelValue","placeholder"])]),i("div",ae,p(a(t)("growthTips")),1)])]),_:1},8,["label"])]),_:1},8,["model","rules"]),i("h3",re,p(a(t)("levelBenefits")),1),i("div",se,[_.value?R("",!0):(h(),b(K,{key:0,ref_key:"benefitsRef",ref:V,modelValue:l.level_benefits,"onUpdate:modelValue":e[4]||(e[4]=s=>l.level_benefits=s)},null,8,["modelValue"]))]),i("h3",ne,p(a(t)("levelGift")),1),i("div",ie,[_.value?R("",!0):(h(),b(W,{key:0,ref_key:"giftRef",ref:y,modelValue:l.level_gifts,"onUpdate:modelValue":e[5]||(e[5]=s=>l.level_gifts=s)},null,8,["modelValue"]))])]),_:1})),[[U,_.value]]),i("div",me,[i("div",de,[n(I,{type:"primary",loading:c.value,onClick:e[6]||(e[6]=s=>P(k.value))},{default:u(()=>[H(p(a(t)("save")),1)]),_:1},8,["loading"])])])])}}});export{ke as default};
