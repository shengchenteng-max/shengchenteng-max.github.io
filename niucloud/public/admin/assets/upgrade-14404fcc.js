import{d as te,r as l,l as P,k as p,X as H,f as oe,h as n,c as d,J as se,m as E,w as o,u as c,a as e,t as u,i as I,B as v,e as s,F as ae,T as le,Y as ne,P as re,E as ie,Z as ce,$ as de,a0 as ue,a1 as pe,a2 as _e,L as me,D as fe,G as ve,H as he,S as xe,M as ge,p as ye,g as Ve,_ as we}from"./index-9f163f98.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                */import"./el-form-item-4ed993c7.js";/* empty css                 *//* empty css                *//* empty css                     *//* empty css                         *//* empty css                         *//* empty css                  */import{s as ke,a as be,g as Fe}from"./module-29351851.js";import Ee from"./index-8ef97a8d.js";import Ie from"./index-ecb691b7.js";/* empty css                  *//* empty css                    *//* empty css               *//* empty css                *//* empty css                 */import"./dark-d503b80a.js";import"./upgrade-e1e2708e.js";/* empty css                   */const Ce=""+new URL("upgrade-615f348d.png",import.meta.url).href,h=w=>(ye("data-v-73202cf3"),w=w(),Ve(),w),Le={class:"main-container"},De={key:0},Se={key:0,class:"mb-[30px]"},Ae=h(()=>e("div",{class:"title text-[16px] font-bold text-[#1D1F3A] mb-[20px]"},"版本信息",-1)),Be={class:"text-[14px] text-[#1D1F3A] mb-[20px]"},Re=h(()=>e("span",null,"系统当前版本：",-1)),Ue={class:"font-bold"},Ne={class:"flex"},Te=h(()=>e("div",{class:"w-[92px] h-[92px] rounded-[10px] flex justify-center items-center mr-[20px]"},[e("img",{src:Ce,class:"w-[92px] h-[92px]"})],-1)),Me={class:"flex flex-col justify-between items-start"},je=h(()=>e("div",{class:"text-[14px] text-[#1D1F3A]"},"系统最新版本为",-1)),Pe={class:"text-[14px] text-[#1D1F3A] font-bold"},He={key:0,class:"text-[#9699B6] text-[16px]"},ze=h(()=>e("span",null,"已是最新",-1)),qe=[ze],$e={key:1},Ge=h(()=>e("div",{class:"panel-title bg-[#F4F5F7] border-[#E6E6E6] border-solid border-b-[1px] h-[40px] flex items-center p-[10px]"},[e("span",{class:"text-[14px] font-500 text-[#1D1F3A]"},"升级记录")],-1)),Je={class:"time-dialog",style:{overflow:"auto"}},Xe={class:"flex justify-between items-start flex-col"},Ye={class:"text-[#1D1F3A] text-[14px] leading-[20px]"},Ze={class:"text-[#9699B6] text-[13px] mt-2"},Ke={class:"ml-auto text-[#374151] flex items-center"},Oe={class:"text-[#374151] text-[14px]"},Qe={key:0,class:"iconfont iconjiantouxia ml-[4px] !text-[10px] transition-transform duration-300"},We={key:1,class:"iconfont iconjiantoushang ml-[4px] !text-[10px] transition-transform duration-300"},et={key:0,class:"px-[20px] py-[20px] bg-overlay timeline-log-wrap whitespace-pre-wrap rounded-[4px] bg-[#F9F9FB] text-[#4F516D]"},tt=["innerHTML"],ot={class:"mt-[20px]"},st={class:"text-sm mt-[10px] text-info"},at={class:"mt-[20px]"},lt={class:"mt-[10px] text-right"},nt=te({__name:"upgrade",setup(w){const C=l(null),z=l(null),_=l(!1),k=l([]),L=l(0),D=l(!1),m=P({auth_code:"",auth_secret:""}),S=l(),q=P({auth_code:[{required:!0,message:p("authCodePlaceholder"),trigger:"blur"}],auth_secret:[{required:!0,message:p("authSecretPlaceholder"),trigger:"blur"}]}),x=l(!1),$=async t=>{x.value||!t||await t.validate(async a=>{a&&(x.value=!0,ke(m).then(()=>{x.value=!1,R()}).catch(()=>{x.value=!1,_.value=!1}))})},g=l(!1);(()=>{g.value=!0,be().then(({data:t})=>{k.value=t,g.value=!1,D.value?(!r.value||r.value&&r.value.version_no==f.value)&&ne({message:p("versionTips"),type:"success"}):D.value=!0}).catch(()=>{g.value=!1})})();const G=H(()=>{if(!r.value||r.value.version_no===f.value)return!1;const t=String(f.value),a=String(r.value.version_no),y=parseInt(t.replace(/\./g,""),10);return parseInt(a.replace(/\./g,""),10)>y}),r=H(()=>k.value.length?k.value[0]:null),J=()=>{_.value=!0},f=l(""),A=l("");(()=>{re().then(t=>{f.value=t.data.version.version,A.value=t.data.version.code})})();const B=l({company_name:"",site_address:"",auth_code:""}),b=l(!1),F=l(!1),X=()=>{var t;if(!B.value.auth_code){J();return}b.value||(b.value=!0,F.value=!0,(t=C.value)==null||t.open("",()=>{b.value=!1,F.value=!1}))},R=()=>{Fe().then(t=>{t.data.data&&t.data.data.length!=0&&(B.value=t.data.data,_.value=!1)}).catch(()=>{_.value=!1})};return R(),oe(),(t,a)=>{const y=ie,U=ce,Y=de,Z=ue,K=pe,O=_e,N=me,T=fe,M=ve,Q=he,W=xe,ee=ge;return n(),d("div",Le,[se((n(),E(N,{class:"box-card !border-none min-h-[500px]",shadow:"never"},{default:o(()=>[g.value?v("",!0):(n(),d("div",De,[c(r)?(n(),d("div",Se,[Ae,e("div",Be,[Re,e("span",Ue,"v"+u(f.value),1)]),e("div",Ne,[Te,e("div",Me,[je,e("div",Pe,"v"+u(c(r).version_no)+"（"+u(A.value)+"）",1),c(G)?(n(),d("div",$e,[!c(r)||c(r)&&c(r).version_no==f.value?v("",!0):(n(),E(y,{key:0,class:"w-[102px] !h-[32px]",type:"primary",loading:F.value,onClick:X},{default:o(()=>[I("一键升级")]),_:1},8,["loading"]))])):(n(),d("div",He,qe))])])])):v("",!0),Ge,e("div",null,[e("div",Je,[s(O,null,{default:o(()=>[s(K,{style:{width:"100%"}},{default:o(()=>[(n(!0),d(ae,null,le(k.value,(i,j)=>(n(),E(Z,{key:j,placement:"left",hollow:!0},{default:o(()=>[s(Y,{modelValue:L.value,"onUpdate:modelValue":a[0]||(a[0]=V=>L.value=V),accordion:""},{default:o(()=>[s(U,{name:j},{title:o(()=>[e("div",Xe,[e("span",Ye,"版本： v"+u(i.version_no),1),e("span",Ze,u(i.release_time),1)])]),icon:o(({isActive:V})=>[e("div",Ke,[e("span",Oe,u(V?"收起":"更新内容"),1),V?v("",!0):(n(),d("span",Qe)),V?(n(),d("span",We)):v("",!0)])]),default:o(()=>[i.upgrade_log?(n(),d("div",et,[e("div",{innerHTML:i.upgrade_log},null,8,tt)])):v("",!0)]),_:2},1032,["name"])]),_:2},1032,["modelValue"])]),_:2},1024))),128))]),_:1})]),_:1})])])]))]),_:1})),[[ee,g.value]]),s(W,{modelValue:_.value,"onUpdate:modelValue":a[4]||(a[4]=i=>_.value=i),title:"授权码认证",width:"400px"},{default:o(()=>[s(Q,{model:m,"label-width":"0",ref_key:"formRef",ref:S,rules:q,class:"page-form"},{default:o(()=>[s(N,{class:"box-card !border-none",shadow:"never"},{default:o(()=>[s(M,{prop:"auth_code"},{default:o(()=>[s(T,{modelValue:m.auth_code,"onUpdate:modelValue":a[1]||(a[1]=i=>m.auth_code=i),modelModifiers:{trim:!0},placeholder:c(p)("authCodePlaceholder"),class:"input-width",clearable:"",size:"large"},null,8,["modelValue","placeholder"])]),_:1}),e("div",ot,[s(M,{prop:"auth_secret"},{default:o(()=>[s(T,{modelValue:m.auth_secret,"onUpdate:modelValue":a[2]||(a[2]=i=>m.auth_secret=i),modelModifiers:{trim:!0},clearable:"",placeholder:c(p)("authSecretPlaceholder"),class:"input-width",size:"large"},null,8,["modelValue","placeholder"])]),_:1})]),e("div",st,u(c(p)("authInfoTips")),1),e("div",at,[s(y,{type:"primary",class:"w-full",size:"large",loading:x.value,onClick:a[3]||(a[3]=i=>$(S.value))},{default:o(()=>[I(u(c(p)("confirm")),1)]),_:1},8,["loading"])]),e("div",lt,[s(y,{type:"primary",link:"",onClick:t.market},{default:o(()=>[I(u(c(p)("notHaveAuth")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),s(Ee,{ref_key:"upgradeRef",ref:C},null,512),s(Ie,{ref_key:"upgradeLogRef",ref:z},null,512)])}}});const At=we(nt,[["__scopeId","data-v-73202cf3"]]);export{At as default};
