import{d as e,r as a,J as t,M as s,o as l,c as r,w as o,b as c,W as u,ab as d,X as n,g as p,y as i,z as f,e as x,n as m,c2 as v,a as _,c3 as b,k as h,G as g,aw as k,i as y,j as C,c4 as w,x as j,A,t as S,c5 as z,F as I}from"./index-837da579.js";import{_ as E}from"./u-popup.80b537cf.js";import{M}from"./mescroll-empty.463919bf.js";import{_ as V}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-transition.38ad69d8.js";import"./u-icon.963870f0.js";import"./mescroll-i18n.54bd5572.js";const B=V(e({__name:"address",setup(e){const V=a(!0),B=a(0),F=a([]),G=a(""),J=a("");t((e=>{G.value=e.type||"",J.value=e.source||"",e.type&&(B.value="address"==e.type?0:1),uni.getStorageSync("selectAddressCallback")&&uni.removeStorage({key:"selectAddressCallback"})}));s((()=>{v({}).then((({data:e})=>{const a=[],t=[];e.forEach((e=>{"address"==e.type?a.push(e):t.push(e)})),J.value?F.value=0==B.value?a:t:F.value=e,V.value=!1})).catch((()=>{V.value=!1}))}));const R=()=>{_({url:"/app/pages/member/address_edit",param:{source:J.value}})},T=a(!1),W=a(0),X=()=>{const e=F.value[W.value];b(e.id).then((()=>{F.value.splice(W.value,1),T.value=!1})).catch()};return(e,a)=>{const t=h,s=I,v=g,b=k,B=y(C("u-popup"),E);return V.value?p("v-if",!0):(l(),r(t,{key:0,class:"address bg-[var(--page-bg-color)] min-h-[100vh]",style:m(e.themeColor())},{default:o((()=>[c(b,{"scroll-y":"true"},{default:o((()=>[F.value.length?(l(),r(t,{key:0,class:"sidebar-margin pt-[var(--top-m)]"},{default:o((()=>[(l(!0),u(n,null,d(F.value,((e,a)=>(l(),r(t,{class:"mb-[var(--top-m)] rounded-[var(--rounded-big)] overflow-hidden"},{default:o((()=>[c(t,{class:"flex flex-col card-template"},{default:o((()=>[c(t,{class:"flex-1 line-feed mr-[20rpx]",onClick:a=>(e=>{const a=uni.getStorageSync("selectAddressCallback");a&&(a.address_id=e.id,uni.setStorage({key:"selectAddressCallback",data:a,success(){_({url:a.back,mode:"redirectTo"})}}))})(e)},{default:o((()=>[c(t,{class:"flex items-center"},{default:o((()=>[c(t,{class:"text-[#333] text-[30rpx] leading-[34rpx] font-500"},{default:o((()=>[i(f(e.name),1)])),_:2},1024),c(s,{class:"text-[#333] text-[30rpx] ml-[10rpx]"},{default:o((()=>[i(f(x(w)(e.mobile)),1)])),_:2},1024)])),_:2},1024),c(t,{class:"mt-[16rpx] text-[26rpx] line-feed text-[var(--text-color-light9)] leading-[1.4]"},{default:o((()=>[i(f(e.full_address),1)])),_:2},1024)])),_:2},1032,["onClick"]),c(t,{class:"flex justify-between pt-[26rpx]"},{default:o((()=>[c(t,{class:"flex items-center text-[26rpx] leading-none",onClick:j((e=>(e=>{const a=F.value[e];a.is_default||(a.is_default=1,z(a).then((()=>{F.value.forEach(((a,t)=>{a.is_default&&(a.is_default=0),t==e&&(a.is_default=1)}))})).catch())})(a)),["stop"])},{default:o((()=>[c(s,{class:A(["iconfont !text-[26rpx] mr-[10rpx]",{"iconduigou text-primary":e.is_default,iconcheckbox_nol:!e.is_default}])},null,8,["class"]),i(" 设为默认 ")])),_:2},1032,["onClick"]),c(t,{class:"flex"},{default:o((()=>[c(t,{class:"text-[26rpx]",onClick:j((a=>{return t=e.id,void _({url:"/app/pages/member/address_edit",param:{id:t,source:J.value}});var t}),["stop"])},{default:o((()=>[c(s,{class:"nc-iconfont nc-icon-xiugaiV6xx shrink-0 text-[26rpx] mr-[4rpx]"}),i(" 编辑 ")])),_:2},1032,["onClick"]),c(t,{onClick:j((e=>(e=>{W.value=e,T.value=!0})(a)),["stop"]),class:"ml-[40rpx] text-[26rpx]"},{default:o((()=>[c(s,{class:"nc-iconfont nc-icon-shanchu-yuangaizhiV6xx shrink-0 text-[26rpx] mr-[4rpx]"}),i(" 删除 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),256))])),_:1})):p("v-if",!0),F.value.length?p("v-if",!0):(l(),r(M,{key:1,option:{tip:"暂无收货地址"}})),c(t,{class:"w-full footer"},{default:o((()=>[c(t,{class:"py-[var(--top-m)] px-[var(--sidebar-m)] footer w-full fixed bottom-0 left-0 right-0 box-border"},{default:o((()=>[c(v,{"hover-class":"none",class:"primary-btn-bg text-[#fff] h-[80rpx] leading-[80rpx] rounded-[100rpx] text-[26rpx] font-500",onClick:R},{default:o((()=>[i(f(x(S)("createAddress")),1)])),_:1})])),_:1})])),_:1})])),_:1}),c(B,{ref:"popupRef",show:T.value,mode:"center",onClose:a[1]||(a[1]=e=>T.value=!1),round:30,zIndex:"99999",safeAreaInsetBottom:!1},{default:o((()=>[c(t,{class:"bg-[#fff] flex flex-col justify-between w-[610rpx] h-[306rpx] rounded-[30rpx] box-border px-[40rpx] pt-[70rpx] pb-[40rpx] relative overflow-hidden"},{default:o((()=>[c(t,{class:"flex-center mb-[80rpx] text-[#333]"},{default:o((()=>[i("确定要删除该地址吗？")])),_:1}),c(t,{class:"flex-between-center"},{default:o((()=>[c(t,{class:"w-[250rpx] h-[66rpx] rounded-full bg-[#eee] flex-center text-[26rpx] font-500 text-[#333]",onClick:a[0]||(a[0]=e=>T.value=!1)},{default:o((()=>[i("取消")])),_:1}),c(t,{class:"w-[250rpx] h-[66rpx] rounded-full primary-btn-bg flex-center text-[26rpx] font-500 text-[#fff]",onClick:X},{default:o((()=>[i("确定")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1},8,["style"]))}}}),[["__scopeId","data-v-f39e5732"]]);export{B as default};
