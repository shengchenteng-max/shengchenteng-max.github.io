import{d as t,r as e,q as i,bJ as c,af as a,bK as l,i as s,j as r,o,c as n,w as d,b as p,x as u,y as v,A as y,z as f,g as x,n as m,W as h,X as k,ab as _,au as g,k as C,aw as b}from"./index-837da579.js";import{_ as w}from"./u-popup.80b537cf.js";const I=t({__name:"area-select",props:{areaId:{type:Number,default:0}},emits:["complete"],setup(t,{expose:I,emit:T}){const j=t,E=e(!1),q=i({province:[],city:[],district:[]}),z=e("province"),A=i({province:null,city:null,district:null}),J=e(0);c(0).then((({data:t})=>{q.province=t})).catch(),a((()=>j.areaId),((t,e)=>{t&&!e&&l(t).then((({data:t})=>{t.province&&(A.province=t.province),t.city&&(A.city=t.city),t.district&&(A.district=t.district)}))}),{immediate:!0}),a((()=>A.province),(()=>{c(A.province.id).then((({data:t})=>{if(q.city=t,z.value="city",A.city){let e=!1,i=-1;for(let c=0;c<t.length;c++)if(A.city.id==t[c].id){e=!0,i=c;break}e?setTimeout((()=>{K("city",i)}),100):A.city=null}})).catch()}),{deep:!0}),a((()=>A.city),(t=>{t?c(A.city.id).then((({data:t})=>{if(q.district=t,z.value="district",A.district){let e=!1,i=-1;for(let c=0;c<t.length;c++)if(A.district.id==t[c].id){e=!0,i=c;break}e?setTimeout((()=>{K("district",i)}),100):A.district=null}t.length||(T("complete",A),E.value=!1)})).catch():(q.district=[],A.district=null)}),{deep:!0});const K=(t,e)=>{const i=Math.max(0,80*(e-2));J.value=i},M=()=>{J.value=0};a((()=>z.value),(t=>{M(),setTimeout((()=>{if("province"===t&&A.province){const t=q.province.findIndex((t=>t.id===A.province.id));t>=0&&K("province",t)}else if("city"===t&&A.city){const t=q.city.findIndex((t=>t.id===A.city.id));t>=0&&K("city",t)}else if("district"===t&&A.district){const t=q.district.findIndex((t=>t.id===A.district.id));t>=0&&K("district",t)}}),150)})),a((()=>A.district),(t=>{t&&(z.value="district",T("complete",A),E.value=!1)}),{deep:!0});return I({open:()=>{E.value=!0,j.areaId&&(z.value="district")}}),(t,e)=>{const i=C,c=b,a=s(r("u-popup"),w);return o(),n(a,{show:E.value,onClose:e[5]||(e[5]=t=>E.value=!1),mode:"bottom",round:10},{default:d((()=>[p(i,{onTouchmove:e[4]||(e[4]=u((()=>{}),["prevent","stop"])),class:"popup-common"},{default:d((()=>[p(i,{class:"title"},{default:d((()=>[v("请选择地区")])),_:1}),p(i,{class:"flex p-[30rpx] pt-[0] text-sm font-500"},{default:d((()=>[q.province.length?(o(),n(i,{key:0,class:y(["flex-1 pr-[10rpx]",{"text-[var(--primary-color)]":"province"==z.value}]),onClick:e[0]||(e[0]=t=>z.value="province")},{default:d((()=>[A.province?(o(),n(i,{key:0},{default:d((()=>[v(f(A.province.name),1)])),_:1})):(o(),n(i,{key:1},{default:d((()=>[v("请选择")])),_:1}))])),_:1},8,["class"])):x("v-if",!0),q.city.length?(o(),n(i,{key:1,class:y(["flex-1 pr-[10rpx]",{"text-[var(--primary-color)]":"city"==z.value}]),onClick:e[1]||(e[1]=t=>z.value="city")},{default:d((()=>[A.city?(o(),n(i,{key:0},{default:d((()=>[v(f(A.city.name),1)])),_:1})):(o(),n(i,{key:1},{default:d((()=>[v("请选择")])),_:1}))])),_:1},8,["class"])):x("v-if",!0),q.district.length?(o(),n(i,{key:2,class:y(["flex-1 pr-[10rpx]",{"text-[var(--primary-color)]":"district"==z.value}]),onClick:e[2]||(e[2]=t=>z.value="district")},{default:d((()=>[A.district?(o(),n(i,{key:0},{default:d((()=>[v(f(A.district.name),1)])),_:1})):(o(),n(i,{key:1},{default:d((()=>[v("请选择")])),_:1}))])),_:1},8,["class"])):(o(),n(i,{key:3,class:"flex-1 pr-[10rpx]"}))])),_:1}),p(c,{"scroll-y":"true",class:"h-[50vh]","scroll-top":J.value,"scroll-with-animation":"",onTouchmove:e[3]||(e[3]=u((()=>{}),["stop"]))},{default:d((()=>[p(i,{class:"flex p-[30rpx] pt-[0] text-sm font-500 h-[50vh]"},{default:d((()=>[q.province.length?(o(),n(i,{key:0,class:"flex-1 pr-[10rpx]",style:m({opacity:"province"==z.value?1:0,pointerEvents:"province"==z.value?"auto":"none",height:"province"==z.value?"auto":"0",overflow:"province"==z.value?"auto":"hidden"})},{default:d((()=>[(o(!0),h(k,null,_(q.province,((t,e)=>(o(),n(i,{key:t.id,class:y(["h-[80rpx] flex items-center",{"text-[var(--primary-color)]":A.province&&A.province.id==t.id}]),onClick:e=>(t=>{A.province=t,g((()=>{M()}))})(t)},{default:d((()=>[v(f(t.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1},8,["style"])):x("v-if",!0),q.city.length?(o(),n(i,{key:1,class:"flex-1 pr-[10rpx]",style:m({opacity:"city"==z.value?1:0,pointerEvents:"city"==z.value?"auto":"none",height:"city"==z.value?"auto":"0",overflow:"city"==z.value?"auto":"hidden"})},{default:d((()=>[(o(!0),h(k,null,_(q.city,((t,e)=>(o(),n(i,{key:t.id,class:y(["h-[80rpx] flex items-center",{"text-[var(--primary-color)]":A.city&&A.city.id==t.id}]),onClick:e=>(t=>{A.city=t,g((()=>{M()}))})(t)},{default:d((()=>[v(f(t.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1},8,["style"])):x("v-if",!0),q.district.length?(o(),n(i,{key:2,class:"flex-1 pr-[10rpx]",style:m({opacity:"district"==z.value?1:0,pointerEvents:"district"==z.value?"auto":"none",height:"district"==z.value?"auto":"0",overflow:"district"==z.value?"auto":"hidden"})},{default:d((()=>[(o(!0),h(k,null,_(q.district,((t,e)=>(o(),n(i,{key:t.id,class:y(["h-[80rpx] flex items-center",{"text-[var(--primary-color)]":A.district&&A.district.id==t.id}]),onClick:e=>A.district=t},{default:d((()=>[v(f(t.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1},8,["style"])):(o(),n(i,{key:3,class:"flex-1 pr-[10rpx]"}))])),_:1})])),_:1},8,["scroll-top"])])),_:1})])),_:1},8,["show"])}}});export{I as _};
